# 修复说明

## 问题修复

### 1. Windows 和 Linux 路径不一致问题

**修复方案**：
- 添加了 `normalizePath()` 函数统一处理路径格式
- 改进了路径处理逻辑，确保跨平台兼容性

### 2. guards.ts 文件被覆盖问题

**修复方案**：
- 只在 guards 文件不存在时才创建，避免覆盖用户自定义代码
- 遵循"自动生成文件保护机制"规范
- 用户如需重新生成，删除现有文件后重启项目即可

### 3. 首页路由判断逻辑错误

**修复方案**：
- 修复了 `createRouteFromFile` 中错误的首页判断逻辑
- 现在正确识别 `Home.vue`、`Index.vue` 等首页文件

### 4. Vue 文件 meta 解析不够健壮

**修复方案**：
- 改进了 `parseVueFileRouteMeta` 函数的正则表达式
- 增强了 `parseRouteMetaObject` 函数，支持更复杂的 params 解析
- 添加了备用方案，提高解析成功率

### 5. 文件监听性能问题

**修复方案**：
- 添加了文件检查缓存机制，减少重复检查
- 优化了路径标准化处理
- 提高了大型项目中的性能

### 6. 配置验证缺失

**修复方案**：
- 添加了 `validateOptions` 函数验证用户配置
- 在插件初始化时提供配置警告
- 提高了错误配置的友好提示

## 主要改进

1. **路径标准化**：所有路径处理现在都使用统一的标准化函数
2. **文件保护**：guards.ts 文件只在首次生成，后续不会被覆盖
3. **解析增强**：Vue 文件 meta 解析更加健壮和精确
4. **性能优化**：文件监听和检查性能显著提升
5. **错误处理**：添加了配置验证和友好的错误提示
6. **跨平台兼容**：在 Windows、Linux、macOS 上都能正常工作

## 使用方式

配置保持不变，无需额外设置：

```typescript
vueAutoRouter({
  output: {
    guards: "src/router/guards.ts",
  },
});
```

- 首次运行会生成 guards 文件
- 之后可以安全地修改该文件
- 如需重新生成，删除文件后重启即可